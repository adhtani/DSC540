(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{mN2R:function(t,e,r){"use strict";r.r(e),r.d(e,"isSupportApiAvailable",(function(){return h})),r.d(e,"supportApi",(function(){return m}));var n=r("mrSG"),s=(r("bSeV"),r("BHQF")),o=r("Wt0y"),i=r("txPx"),u=(r("NNtz"),Object(i.getLogger)("Support.Api")),c=window.DATA_ISSUES_HOST,a=void 0!==c?c+"/api/v1":void 0;function h(){return void 0!==a}function l(t){if(!h())throw new Error("Helpdesk host is not defined.");return""+a+t}var d={count:function(){return{method:"GET",url:l("/tickets/count_by_userid")}},list:function(){return{method:"GET",url:l("/tickets/by_userid")}},get:function(t){return{method:"GET",url:l("/tickets/"+t)}},send:function(){return{method:"POST",url:l("/tickets/save")}},close:function(){return{method:"POST",url:l("/tickets/close")}},getSatisfactionRatings:function(t){return{method:"GET",url:l("/tickets/"+t+"/get_satisfaction_ratings")}},addSatisfactionRating:function(t){return{method:"POST",url:l("/tickets/"+t+"/add_satisfaction_rating")}}},f={list:function(t){return{method:"GET",url:l("/tickets/"+t+"/comments")}},send:function(){return{method:"POST",url:l("/tickets/add_comment")}}},b={get:function(){return{method:"GET",url:l("/unreads/get")}},update:function(){return{method:"PATCH",url:l("/unreads/update")}},drop:function(){return{method:"PATCH",url:l("/unreads/drop")}}},g={getPopulars:function(t){return{method:"GET",url:l("/solutions/popular/"+t)}},getTree:function(t){return{method:"GET",url:l("/solutions/get_solutions_tree/"+t)}},search:function(t,e){return{method:"GET",url:l("/solutions/search/"+t+"?term="+e)}},get:function(t,e){return{method:"GET",url:l("/solutions/"+t+"/"+e)}}},w={get:function(){return{method:"GET",url:l("/business_hours")}}},v={get:function(t){return{method:"GET",url:l("/freshdeskId/"+t)}}};function p(t,e,r){var n={method:t,credentials:"include"};return n.headers=new Headers,Object(o.isProd)()||(n.headers.set("X-UserId",String(window.user.id)),n.headers.set("X-UserPerm",JSON.stringify({is_pro_admin:1,is_support_unreads_admin:1}))),void 0!==r&&(n.headers.set("Content-Type","application/json"),n.body=JSON.stringify(r)),Object(s.fetch)(e,n)}function O(t){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(r){switch(r.label){case 0:return[4,t.text()];case 1:if(e=r.sent(),!t.ok)throw new Error("Response was not OK. Status: "+t.status+". Content: "+e);return[2,e]}}))}))}function E(t){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(r){switch(r.label){case 0:return[4,O(t)];case 1:e=r.sent();try{return[2,JSON.parse(e)]}catch(n){throw new Error("Failed to parse JSON response (at "+t.url+'). Original error: "'+n.name+": "+n.message+'". Tried to parse: '+e)}return[2]}}))}))}var m={tickets:{count:function(){return Object(n.b)(this,void 0,void 0,(function(){var t,e,r,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=d.count(),e=t.method,r=t.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(e,r)];case 2:return[4,E(n.sent())];case 3:
return[2,n.sent()];case 4:throw s=n.sent(),u.logError("Error while fetching tickets count. "+s),s;case 5:return[2]}}))}))},list:function(){return Object(n.b)(this,void 0,void 0,(function(){var t,e,r,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=d.list(),e=t.method,r=t.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(e,r)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw s=n.sent(),u.logError("Error while fetching tickets. "+s),s;case 5:return[2]}}))}))},get:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=d.get(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching ticket "+t+". "+o),o;case 5:return[2]}}))}))},send:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=d.send(),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s,t)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while sending new ticket. "+o),o;case 5:return[2]}}))}))},close:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=d.close(),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s,t)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching ticket "+t.reportId+". "+o),o;case 5:return[2]}}))}))},getSatisfactionRatings:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=d.getSatisfactionRatings(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching ticket satisfaction ratings. "+o),o;case 5:return[2]}}))}))},addSatisfactionRating:function(t,e){return Object(n.b)(this,void 0,void 0,(function(){var r,s,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:r=d.addSatisfactionRating(t),s=r.method,o=r.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(s,o,e)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw i=n.sent(),u.logError("Error while sending new ticket satisfaction rating. "+i),i;case 5:return[2]}}))}))}},conversations:{list:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=f.list(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching ticket conversations. "+o),o;case 5:return[2]}}))}))},send:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){
switch(n.label){case 0:e=f.send(),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s,t)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while sending new ticket note. "+o),o;case 5:return[2]}}))}))}},unreads:{get:function(){return Object(n.b)(this,void 0,void 0,(function(){var t,e,r,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=b.get(),e=t.method,r=t.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(e,r)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw s=n.sent(),u.logWarn("Error while fetching support unreads count. "+s),s;case 5:return[2]}}))}))},update:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=b.update(),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s,t)];case 2:return[4,O(n.sent())];case 3:return n.sent(),[3,5];case 4:throw o=n.sent(),u.logError("Error while updating ticket conversations unreads. "+o),o;case 5:return[2]}}))}))},drop:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=b.drop(),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s,t)];case 2:return[4,O(n.sent())];case 3:return n.sent(),[3,5];case 4:throw o=n.sent(),u.logError("Error while dropping ticket conversations unreads. "+o),o;case 5:return[2]}}))}))}},solutions:{getPopulars:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=g.getPopulars(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching popular solutions. "+o),o;case 5:return[2]}}))}))},getTree:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=g.getTree(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logError("Error while fetching solutions tree. "+o),o;case 5:return[2]}}))}))},search:function(t,e){return Object(n.b)(this,void 0,void 0,(function(){var r,s,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:r=g.search(t,e),s=r.method,o=r.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(s,o)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw i=n.sent(),u.logError("Error while searching solutions. "+i),i;case 5:return[2]}}))}))},get:function(t,e){return Object(n.b)(this,void 0,void 0,(function(){var r,s,o,i;return Object(n.d)(this,(function(n){switch(n.label){case 0:r=g.get(t,e),s=r.method,o=r.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(s,o)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw i=n.sent(),u.logError("Error while fetching solution "+t+". "+i),i;case 5:return[2]}}))}))
}},businessHours:{get:function(){return Object(n.b)(this,void 0,void 0,(function(){var t,e,r,s;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=w.get(),e=t.method,r=t.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(e,r)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw s=n.sent(),u.logError("Error while fetching support business hours. "+s),s;case 5:return[2]}}))}))}},freshdeskId:{get:function(t){return Object(n.b)(this,void 0,void 0,(function(){var e,r,s,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:e=v.get(t),r=e.method,s=e.url,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,p(r,s)];case 2:return[4,E(n.sent())];case 3:return[2,n.sent()];case 4:throw o=n.sent(),u.logWarn("Error while fetching user Freshdesk ID. "+o),o;case 5:return[2]}}))}))}}}}}]);