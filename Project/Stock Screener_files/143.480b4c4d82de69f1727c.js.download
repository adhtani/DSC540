(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{"+slJ":function(e,t,n){"use strict";function r(e){return i().then((function(t){return t.hasUserAccessToDataSource(e)}))}function o(e){return i().then((function(t){return t.filterAccessibleDataSources(e)}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var i=function(){return Promise.all([n.e("vendors"),n.e(192),n.e(15),n.e(28),n.e(34),n.e(39),n.e(40),n.e(41),n.e(62),n.e(54),n.e(65),n.e(63),n.e(66),n.e(105),n.e(117),n.e(123),n.e(116),n.e(124),n.e(134),n.e(137),n.e(138),n.e(115),n.e(151),n.e(141),n.e(152),n.e(167),n.e(176),n.e(191),n.e(305),n.e("alert-utils-has-user-access-to-data-source")]).then(n.bind(null,"SlIP"))}},"0dm4":function(e,t,n){"use strict";n.r(t),n.d(t,"canPlaceAlertOnResolution",(function(){return a}));var r=n("LxhU"),o=n("NP3r"),i=n("bKsZ");function a(e){return!r.Interval.isSeconds(e)||Object(o.enabled)(i.ProductFeatures.ALERTS_ON_SECONDS)}},"1UCy":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"AlertEditorAbortReason",(function(){return r})),function(e){e.AlertIsInvalid="alert-is-invalid",e.AlertsMaintenance="alerts-maintenance",e.ChartModelNotFound="chart-model-not-found",e.IsAlreadyPresent="is-already-present",e.MainSeriesIsATR="main-series-is-atr",e.MainSeriesIsInReplay="main-series-is-in-replay",e.MainSeriesIsOffline="main-series-is-offline",e.SourceIsDangerous="source-is-dangerous",e.SymbolInfoTimeout="symbol-info-timeout",e.SymbolIsInvalid="symbol-is-invalid",e.UnsupportedResolution="unsupported-resolution",e.ManualAbort="manual-abort"}(r||(r={}))},"2O5g":function(e,t,n){"use strict";n.r(t),n.d(t,"invokeAlertEditor",(function(){return f})),n.d(t,"invokeAlertEditorWithOnlineSeries",(function(){return A}));var r=n("mrSG"),o=n("PlME"),i=n("JUY+"),a=n("1UCy"),s=n("+slJ"),l=n("txPx"),u=n("K81e"),c=n("8I+7"),d=Object(l.getLogger)("Alerts.Price.InvokeAlertEditor");function f(e){c.alertsMaintenanceTracker.sync();var t=Object(o.shouldAbortAlertEditor)(e);if(null!==t)return t!==a.AlertEditorAbortReason.IsAlreadyPresent&&Object(o.showAbortExplainingDialog)(t,Object(o.getAlertDialogType)(e)),d.logWarn("Aborted: "+t),void(e.onAborted&&e.onAborted(t));var r=u.alertEditorInvocationHandler.lockInvocation(e),s=r.unlockInvocation,l=r.abortSignal;Promise.all([Promise.all([n.e("vendors"),n.e(83),n.e(65),n.e(63),n.e(66),n.e(96),n.e(116),n.e(289),n.e("alert-editor-impl")]).then(n.t.bind(null,"Hlqb",7)),Object(i.getPriceAlertsDispatcher)(),b(e,s,l)]).then((function(e){var t=e[0],n=e[1],r=e[2];new t.AlertEditor(n,r)}),s)}function b(e,t,n){return(e.series?Object(s.b)(e.series):Promise.resolve(!0)).then((function(o){var i=e.onDestroy,a=Object(r.a)(Object(r.a)({},e),{abortSignal:n,onDestroy:function(){t(),i&&i()}});return o||(delete a.series,delete a.value),a}))}function A(e){e.dataSourceHub?Object(o.ensureSeriesIsNotOffline)(e.dataSourceHub.mainSeries()).then((function(){f(e)})):f(e)}},"8I+7":function(e,t,n){"use strict";n.r(t),n.d(t,"alertsMaintenanceTracker",(function(){return a}));var r=n("hY0g"),o=n.n(r),i=n("+GxX"),a=new(function(){
function e(){this._state=new o.a(Object(i.isFeatureEnabled)("alerts-maintenance"))}return e.prototype.value=function(){return this._state.value()},e.prototype.subscribe=function(e){this._state.subscribe(e)},e.prototype.unsubscribe=function(e){this._state.unsubscribe(e)},e.prototype.sync=function(){this._state.setValue(Object(i.isFeatureEnabled)("alerts-maintenance"))},e}())},K81e:function(e,t,n){"use strict";n.r(t),n.d(t,"ALERT_DIALOG_CREATE_INVOCATION_ID",(function(){return s})),n.d(t,"AlertEditorInvocationHandler",(function(){return u})),n.d(t,"alertEditorInvocationHandler",(function(){return c}));var r=n("hY0g"),o=n.n(r),i=n("PlME"),a=n("Eyy1"),s=-1,l=function(){function e(){this._state=new o.a(!1)}return e.prototype.subscribe=function(e){this._state.subscribe(e)},e.prototype.unsubscribe=function(e){this._state.unsubscribe(e)},e.prototype.value=function(){return this._state.value()},e.prototype.abort=function(){this._state.setValue(!0)},e}(),u=function(){function e(){this._dialogInvocations=new o.a(new Map)}return e.prototype.getDialogInvocations=function(){return this._dialogInvocations},e.prototype.isAllowedToInvoke=function(e){return e.silent||!this._dialogInvocations.value().has(d(e))},e.prototype.lockInvocation=function(e){var t=this;if(e.silent)return{unlockInvocation:function(){}};var n=d(e),r=new l,o=new Map(this._dialogInvocations.value());return o.set(n,r),this._dialogInvocations.setValue(o),{abortSignal:r,unlockInvocation:function(){var e=new Map(t._dialogInvocations.value());e.delete(n),t._dialogInvocations.setValue(e)}}},e}(),c=new u;function d(e){return"create_alert"===Object(i.getAlertDialogType)(e)?s:Object(a.ensureDefined)(e.alert).id}},PlME:function(e,t,n){"use strict";n.r(t),n.d(t,"getAlertDialogType",(function(){return f})),n.d(t,"shouldAbortAlertEditor",(function(){return b})),n.d(t,"showAbortExplainingDialog",(function(){return v})),n.d(t,"ensureSeriesIsNotOffline",(function(){return I}));var r=n("YFKU"),o=n("brCa"),i=n("1UCy"),a=n("dfhE"),s=n("PT1i"),l=n("K81e"),u=n("0dm4"),c=n("oOPW"),d=n("8I+7");function f(e){return e.alert?e.type||"edit_alert":"create_alert"}function b(e){var t;if(d.alertsMaintenanceTracker.value())return i.AlertEditorAbortReason.AlertsMaintenance;if(!e.alert&&!e.dataSourceHub)return i.AlertEditorAbortReason.ChartModelNotFound;if(!l.alertEditorInvocationHandler.isAllowedToInvoke(e))return i.AlertEditorAbortReason.IsAlreadyPresent;var n=null===(t=e.dataSourceHub)||void 0===t?void 0:t.mainSeries();if(n&&A(n))return i.AlertEditorAbortReason.MainSeriesIsOffline;if(n&&function(e){return e.status()===a.STATUS_INVALID_SYMBOL}(n))return i.AlertEditorAbortReason.SymbolIsInvalid;var r=f(e);if("create_alert"===r&&n&&function(e){var t;return"ATR"===(null===(t=e.stateForAlert().styleInputs)||void 0===t?void 0:t.style)}(n))return i.AlertEditorAbortReason.MainSeriesIsATR;if("create_alert"===r&&n&&function(e){return e.isInReplay()}(n))return i.AlertEditorAbortReason.MainSeriesIsInReplay;var o=n?n.interval():s.linking.interval.value()
;return"create_alert"!==r||Object(u.canPlaceAlertOnResolution)(o)?null:i.AlertEditorAbortReason.UnsupportedResolution}function A(e){return e.status()===a.STATUS_OFFLINE}function v(e,t){if(!p.has(e)){p.add(e);var n=function(){return p.delete(e)},a=function(e){return new Map([[i.AlertEditorAbortReason.UnsupportedResolution,"alertsOnSeconds"]]).get(e)||null}(e);if(a)Object(c.createGoProDialog)({feature:a,actionAfterClose:n});else{var s=function(e,t){var n=r.t("Oops!"),o=r.t("Alert editor could not be initialized");return new Map([[i.AlertEditorAbortReason.AlertsMaintenance,{title:r.t("Alerts maintenance"),content:r.t("We are doing some brief daily maintenance. Alerts will be back really soon, thanks for your patience!")}],[i.AlertEditorAbortReason.MainSeriesIsOffline,{title:n,content:("create_alert"===t?r.t("Cannot create an alert while offline"):r.t("Cannot edit an alert while offline"))+". "+r.t("Please check your internet connection")+"."}],[i.AlertEditorAbortReason.SymbolIsInvalid,{title:n,content:"create_alert"===t?r.t("Can't create alert on invalid symbol"):r.t("Can't edit alert on invalid symbol")}],[i.AlertEditorAbortReason.MainSeriesIsATR,{title:r.t("Alert cannot be set on an ATR-based chart"),content:r.t("Your alert won't trigger the way you expect it to! Inputs for ATR-based charts are recalculated each time you open a chart and are generally dependent on time. Please use the traditional chart type to set an alert with a static box size.")}],[i.AlertEditorAbortReason.MainSeriesIsInReplay,{title:n,content:r.t("Alert creating is not available in replay mode.")}]]).get(e)||{title:n,content:o}}(e,t);Object(o.createNoticeDialog)(s).then((function(e){e.on("beforeClose",n),e.open()}))}}}var p=new Set;function I(e){return new Promise((function(t){if(A(e)){var n=function(){A(e)||(e.onStatusChanged().unsubscribe(null,n),t())};e.onStatusChanged().subscribe(null,n)}else t()}))}}}]);