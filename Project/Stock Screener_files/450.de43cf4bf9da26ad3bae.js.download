(window.webpackJsonp=window.webpackJsonp||[]).push([[450],{"1tvW":function(t,e,r){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},s=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();e.createScreenerAlertsListDialog=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new g(n({},h,t))},r("C66E");var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r("9uLv")),a=r("tKRU");function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var d=r("JOqt").debounce,u={table:'<table class="tv-screener-alerts-list-dialog__table tv-screener-alerts-list-dialog__table--space-bottom">\n\t\t<colgroup>\n\t\t\t<col span="2">\n\t\t\t<col width="160" class="i-collapsing">\n\t\t\t<col width="50">\n\t\t</colgroup>\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th class="tv-screener-alerts-list-dialog__table-head">'+$.t("Screen")+'</th>\n\t\t\t\t<th class="tv-screener-alerts-list-dialog__table-head">'+$.t("Symbols")+'</th>\n\t\t\t\t<th class="tv-screener-alerts-list-dialog__table-head i-collapsing">'+$.t("Fired")+'</th>\n\t\t\t\t<th class="tv-screener-alerts-list-dialog__table-head">&nbsp;</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody class="js-rows-container"></tbody>\n\t</table>',
row:'<tr data-id="{{id}}" data-alert-id="{{alert_id}}" class="tv-screener-alerts-list-dialog__row js-item-row{{#new_item}} js-new-item{{/new_item}}">\n\t\t<td class="tv-screener-alerts-list-dialog__table-cell">\n\t\t\t<div class="tv-screener-alerts-list-dialog__table-cell-wrap apply-overflow-tooltip apply-overflow-tooltip--allow-text"><span data-filter="{{filter_set_id}}" data-market="{{market}}" class="tv-screener-alerts-list-dialog__link js-filter">{{filter_name}}</span></div>\n\t\t</td>\n\t\t<td class="tv-screener-alerts-list-dialog__table-cell">\n\t\t\t<div class="tv-screener-alerts-list-dialog__table-cell-wrap apply-overflow-tooltip apply-overflow-tooltip--allow-text">{{#symbols}}<span\n\t\t\t\tdata-symbol="{{full}}" class="tv-screener-alerts-list-dialog__link js-symbol">{{short}}</span>{{^last}}, {{/last}}{{/symbols}}\n\t\t\t</div>\n\t\t</td>\n\t\t<td class="tv-screener-alerts-list-dialog__table-cell i-collapsing">\n\t\t\t<div class="tv-screener-alerts-list-dialog__table-cell-wrap">{{fired}}</div>\n\t\t</td>\n\t\t<td class="tv-screener-alerts-list-dialog__table-cell">\n\t\t\t<div class="tv-screener-alerts-list-dialog__alert-controls">\n\t\t\t\t<span class="tv-screener-alerts-list-dialog__alert-controls-icon tv-screener-alerts-list-dialog__alert-controls-icon--settings js-icon-edit apply-common-tooltip" title="'+$.t("Edit Alert Settings")+'">\n\t\t\t\t\t'+r("f7DG")+"\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</td>\n\t</tr>"},h={title:$.t("Alerts Log"),width:600,contentWrapTemplate:u.table,closeOnOutsideClick:!1,closeOnClickAtOtherDialogs:!1,destroyOnClose:!0},g=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,r);var i=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return i.symbolClick=new t,i.editClick=new t,i.filterClick=new t,i.$rowsContainer=i.$content.find(".js-rows-container"),i.$rowsContainer.on("click",".js-icon-edit",(function(t){var e=$(t.currentTarget).closest(".js-item-row"),r=+e.attr("data-id"),n=e.attr("data-alert-id");i.editClick.fire(r,n)})).on("click",".js-symbol",(function(t){i.symbolClick.fire($(t.currentTarget).data("symbol"))})).on("click",".js-filter",(function(t){i.filterClick.fire(String($(t.currentTarget).data("filter")),$(t.currentTarget).data("market"))})),i.updateView=d((function(){i.calcHeight(),i.fixPos()}),0),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,e),s(r,[{key:"clearRows",value:function(){this.$rowsContainer.empty()}},{key:"addRows",value:function(t){var e=this;if(this.removeEmptyStub(),!this.opened&&t.length>100){var r=t.slice(),i=r.splice(100,1/0);return this._appendRows(r),this.updateView(),new Promise((function(t){e.once("afterOpen",(function(){e._appendRows(i),t()}))}))}return this._appendRows(t),this.updateView(),Promise.resolve()}},{
key:"hasRow",value:function(t){return!!this.$rowsContainer.find('[data-id="'+t+'"]').size()}},{key:"highlightNew",value:function(){var t=this.$rowsContainer.find(".js-new-item");t.size()&&(t.removeClass("js-new-item").addClass("tv-screener-alerts-list-dialog__row--highlighted"),setTimeout((function(){return t.removeClass("tv-screener-alerts-list-dialog__row--highlighted")}),l.dur))}},{key:"setEmptyStub",value:function(){this.$content.addClass("js-hidden"),$('<div class="tv-screener-alerts-list-dialog__empty-stub js-empty-stub">').text($.t("No alerts triggered")).insertAfter(this.$content)}},{key:"removeEmptyStub",value:function(){this.$el.find(".js-empty-stub").remove(),this.$content.removeClass("js-hidden")}},{key:"_appendRows",value:function(t){for(var e="",r=0;r<t.length;++r){var n=Object.assign({},t[r]);Array.isArray(n.symbols)&&(n.symbols=n.symbols.slice(),n.symbols[n.symbols.length-1].last=!0),e+=i.render(u.row,n)}this.$rowsContainer.get(0).insertAdjacentHTML("beforeend",e)}}]),r}(a.TVPopup)}).call(this,r("aIyQ"),r("nbsC"))},"8QG1":function(t,e,r){"use strict";var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();var n=r("1tvW").createScreenerAlertsListDialog,s=r("JOqt").debounce,l=r("2uTr").appendEllipsis,a=r("aIyQ"),o={ctl_dropdown:'\n\t\t<div class="tv-dropdown-behavior__item">\n\t\t\t<div class="tv-control-select__option-wrap tv-screener-popup__item js-alert-settings">'+l($.t("Edit Alert Settings"))+'</div>\n\t\t</div>\n\t\t<div class="tv-dropdown-behavior__item">\n\t\t\t<div class="tv-control-select__option-wrap tv-screener-popup__item js-alerts-log">'+l($.t("Alerts Log"))+"</div>\n\t\t</div>\n\t"},c=function(){function t(e,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bridge=e,this._bridge.getAlertsCtlDropdownContent=function(){return i.getCtlDropdownContent()},this._model=r,this.editAlertTrigger=new a,this.setupCtlDropdownContentUpdate(),this._model.eventsUpdated.subscribe(this,this.updateEventsLogDialogContent)}return i(t,[{key:"reset",value:function(){this._eventsLogDialog&&(this._eventsLogDialog.close(),delete this._eventsLogDialog),delete this.$ctlContent}},{key:"setupCtlDropdownContentUpdate",value:function(){var t=this,e=s((function(){return t.updateCtlDropdownContent()}),300);this._model.currentAlertStateChange.subscribe(this,e),this._model.alertChanged.subscribe(this,e),this._model.alertsUpdated.subscribe(this,e)}},{key:"getCtlDropdownContent",value:function(){var t=this;return this.$ctlContent||(this.$ctlContent=$(o.ctl_dropdown),this.$ctlContent.on("click",".js-alert-settings",(function(e){t.editAlertTrigger.fire(),t.$ctlContent.trigger("close")})).on("click",".js-alerts-log",(function(e){t.showEventsLogDialog(),t.$ctlContent.trigger("close")}))),this.$ctlContent}},{key:"updateCtlDropdownContent",value:function(){
this.getCtlDropdownContent().find(".js-alert-settings").text(l(this._model.getCurrentAlert()?$.t("Edit Alert Settings"):$.t("Enable Alert")))}},{key:"showEventsLogDialog",value:function(){var t=this;this._eventsLogDialog=n(),this._eventsLogDialog.editClick.subscribe(null,(function(e,r){t.editAlertTrigger.fire(+r),t._eventsLogDialog.close()})),this._eventsLogDialog.symbolClick.subscribe(null,(function(e){return t._bridge.applySymbol(e)})),this._eventsLogDialog.filterClick.subscribe(null,(function(e,r){t._ignoreFilterClick||(t._ignoreFilterClick=!0,t._bridge.applyFilterSet(e,r).then((function(){delete t._ignoreFilterClick})))})),this.updateEventsLogDialogContent(!0),this._eventsLogDialog.open(),this._eventsLogDialog.on("beforeClose",(function(){delete t._eventsLogDialog}))}},{key:"updateEventsLogDialogContent",value:function(t){var e=this;if(this._eventsLogDialog){for(var r=this._model.dispatcher.events.toArray(),i=[],n=r.length;n--;){var s=r[n];i.push({id:s.id,alert_id:s.alertId,market:s.params.scannerParams.country,filter_set_id:s.params.filterSetId,filter_name:this._model.getFilterTitle(s.params.filterSetId)||$.t("Screen"),symbols:s.symbols.map((function(t){return{full:t,short:t.replace(/^[^:]+:/,"")}})),fired:s.fired.toLocaleDateString()+" "+s.fired.toLocaleTimeString(),new_item:!0!==t&&!this._eventsLogDialog.hasRow(s.id)})}this._eventsLogDialog.clearRows(),i.length?this._eventsLogDialog.addRows(i).then((function(){!0!==t&&e._eventsLogDialog.highlightNew()})):this._eventsLogDialog.setEmptyStub()}}}]),t}();t.exports=c},C66E:function(t,e,r){},ajX1:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScreenerAlerts=e.ALERT_STATUS=void 0;var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=r("NlyR");var s=r("Wt0y").environment,l=r("8QG1"),a=r("CoNv").ScreenerAlertsDispatcher,o=r("aIyQ"),c=(0,r("txPx").getLogger)("Alerts.Screener"),d=e.ALERT_STATUS={NEW:"new",RESTART:"restart"};e.ScreenerAlerts=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._bridge=e,this._model=r,this.alertsUpdated=new o,this.eventsUpdated=new o,this.currentAlertStateChange=new o,this.currentAlertLoading=new o,this.alertChanged=new o,this.alertStarted=new o,this._view=new l(e,this),this._view.editAlertTrigger.subscribe(this,this.onEditAlertTrigger),this.initDispatcher(),this.init(),"battle"!==s()&&(window._exposed_screenerAlerts=this)}return i(t,[{key:"initDispatcher",value:function(){var t=this;this._dispatcher=new a,this._dispatcher.setFilterTitleGetter((function(e){return t.getFilterTitle(e)})),this._dispatcher.setScannerParamsGetter((function(e){return t._getFilterScannerParams(e)}))}},{key:"init",value:function(){var t=this,e=function(){t._screenerReady=new Promise((function(e){t._model.loadingComplete.subscribe(null,(function(){return e()
}),!0)}))};this._model.loadingStart.subscribe(null,e),e();var r=function(){t.ready=t._screenerReady.then((function(){return t._dispatcher.loading})).catch((function(t){return c.logError(t&&t.message||$.t("Unknown Error"))}))};window.loginStateChange&&window.loginStateChange.subscribe(null,r),r(),this._model.filterSetChanged.subscribe(this,this.onFilterSetChanged),this.onFilterSetChanged(),this._model.filterSetDeleted.subscribe(this,this.onFilterSetDeleted),this._model.filterSetSaved.subscribe(this,this.onFilterSetSaved),this._dispatcher.alerts.itemsChanged.subscribe(null,(function(){return t.onAlertsUpdated()})),this._dispatcher.alerts.itemsUpdated.subscribe(null,(function(){return t.onAlertsUpdated()})),this._dispatcher.events.itemsChanged.subscribe(null,(function(){return t.eventsUpdated.fire()}))}},{key:"onAlertsUpdated",value:function(){var t=this.getCurrentAlert();this.setCurrentAlertState(t&&t.state||"absent"),this.alertsUpdated.fire()}},{key:"onFilterSetChanged",value:function(t){var e=this;this.ready.then((function(){t||(t=e._bridge.getCurrentFilterSetId());var r=e._dispatcher.alerts.getByFilterSetId(t,e._model.market)[0];e.setCurrentAlertState(r&&r.state||"absent"),e.alertChanged.fire()})).catch((function(t){return c.logError(t&&t.message||$.t("Unknown Error"))}))}},{key:"onFilterSetSaved",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._model.getFilterSetById(t),n=this._dispatcher.alerts.getByFilterSetId(t,e);if(n&&n.length){var s=n[0],l=null;if(i.title!==s.params.filterTitle&&(s.params.filterTitle=i.title,r||(l=this._dispatcher.saveAlert(s.id))),r){var a=this._getFilterScannerParams(t);a?(s.params.scannerParams=a,l=this._dispatcher.cloneAlert(s.id)):c.logError("Unable to get scanner params for filter with id "+t)}l&&l.catch((function(t){return c.logError(t&&t.message||t||"Unknown Error")}))}else this.setCurrentAlertState("absent")&&this.alertChanged.fire()}},{key:"onFilterSetDeleted",value:function(t){var e=this._dispatcher.alerts.getByFilterSetId(t).map((function(t){return t.id}));e.length&&this._dispatcher.deleteAlerts(e).catch((function(t){return c.logError(t&&t.message||$.t("Unknown Error"))}))}},{key:"onEditAlertTrigger",value:function(t){var e=this;if(t)this._dispatcher.showEditAlertDialog(t);else{var r=this._bridge.getCurrentFilterSetId(),i=r&&this._dispatcher.alerts.getByFilterSetId(r,this._model.market)[0];if(i)this._dispatcher.showEditAlertDialog(i.id);else if(!this._model.showNoticeIfNoFilters(r)){var s=this._dispatcher.showCreateAlertDialog(r,!0,(0,n.getAlertsMessageText)(this._model.selectedIntervalId));if(!s)return;s.then((function(){e._emitAlertStartStatusAfterSubmit(d.NEW),e._emitCurrentAlertLoadingAfterSubmit()}))}}}},{key:"_getFilterScannerParams",value:function(t){var e=this._model.getScannerParams(t);return e&&(e.country=this._model.market),e}},{key:"setCurrentAlertState",value:function(t){return this._currentAlertState!==t&&(this.currentAlertStateChange.fire(t),this._currentAlertState=t,!0)}},{key:"getFilterTitle",value:function(t){
var e=this._model.getFilterSetById(t);return e&&e.title||null}},{key:"getFilterSetIdsWithRunningAlerts",value:function(){var t=this;return this._dispatcher.alerts.getRunning().filter((function(e){return e.filterSetId&&e.params.scannerParams.country===t._model.market})).map((function(t){return t.filterSetId}))}},{key:"getCurrentAlert",value:function(){var t=this._bridge.getCurrentFilterSetId();return t&&this._dispatcher.alerts.getByFilterSetId(t,this._model.market)[0]}},{key:"toggleAlert",value:function(t){var e=this,r=this._bridge.getCurrentFilterSetId()===t,i=this._dispatcher.alerts.getByFilterSetId(t,this._model.market)[0];if(i)if("running"===i.state)this._dispatcher.stopAlert(i.id),r&&this.currentAlertLoading.fire();else{var s=this._dispatcher.showEditAlertDialog(i.id,!0);if(!s)return;s.then((function(){e._emitAlertStartStatusAfterSubmit(d.RESTART),r&&e._emitCurrentAlertLoadingAfterSubmit()}))}else{if(this._model.showNoticeIfNoFilters(t))return;var l=this._dispatcher.showCreateAlertDialog(t,!0,(0,n.getAlertsMessageText)(this._model.selectedIntervalId));if(!l)return;l.then((function(){e._emitAlertStartStatusAfterSubmit(d.NEW),r&&e._emitCurrentAlertLoadingAfterSubmit()}))}}},{key:"_emitCurrentAlertLoadingAfterSubmit",value:function(){var t=this;this._dispatcher.getDialogSubmitDelegate().subscribe(null,(function(){return t.currentAlertLoading.fire()}),!0)}},{key:"_emitAlertStartStatusAfterSubmit",value:function(t){var e=this;this._dispatcher.getDialogSubmitDelegate().subscribe(null,(function(){return e.alertStarted.fire(t)}),!0)}},{key:"dispatcher",get:function(){return this._dispatcher}},{key:"view",get:function(){return this._view}}]),t}()},f7DG:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><path fill-rule="evenodd" d="M0 2.006C0 .898.897 0 2.006 0h9.988C13.102 0 14 .897 14 2.006v9.988A2.005 2.005 0 0 1 11.994 14H2.006A2.005 2.005 0 0 1 0 11.994V2.006zm11.119 4.28s-.357 0-.452-.334a3.415 3.415 0 0 0-.334-.81c-.143-.309.096-.547.096-.547l.357-.357c.143-.143.143-.38 0-.548l-.476-.476c-.143-.143-.381-.143-.548 0l-.357.357s-.238.239-.548.096a3.415 3.415 0 0 0-.81-.334c-.333-.095-.333-.452-.333-.452v-.5A.376.376 0 0 0 7.334 2h-.667a.376.376 0 0 0-.381.381v.5s0 .357-.334.452c-.285.072-.547.19-.81.334-.309.143-.547-.096-.547-.096l-.357-.357c-.143-.143-.38-.143-.548 0l-.476.476c-.143.143-.143.381 0 .548l.357.357s.239.238.096.548a3.415 3.415 0 0 0-.334.81c-.095.309-.452.333-.452.333h-.5a.376.376 0 0 0-.381.38v.667c0 .215.167.381.381.381h.5s.357 0 .452.334c.072.285.19.547.334.81.143.309-.096.547-.096.547l-.357.357c-.143.143-.143.38 0 .548l.476.476c.143.143.381.143.548 0l.357-.357s.238-.239.548-.096c.262.143.524.262.81.334.309.095.333.452.333.452v.5c0 .214.166.381.38.381h.667a.376.376 0 0 0 .381-.381v-.5s0-.357.334-.452c.285-.072.547-.19.81-.334.309-.143.547.096.547.096l.357.357c.143.143.38.143.548 0l.476-.476c.143-.143.143-.381 0-.548l-.357-.357s-.239-.238-.096-.548c.143-.262.262-.524.334-.81.095-.309.452-.333.452-.333h.5a.376.376 0 0 0 .381-.38v-.667a.376.376 0 0 0-.381-.381h-.5zM7 9c-1.111 0-2-.889-2-2s.889-2 2-2 2 .889 2 2-.906 2-2 2z"/></svg>'},nec0:function(t,e,r){},uo4K:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 13" width="13" height="13"><path fill="currentColor" d="M5.18 6.6L1.3 2.7.6 2 2 .59l.7.7 3.9 3.9 3.89-3.9.7-.7L12.61 2l-.71.7L8 6.6l3.89 3.89.7.7-1.4 1.42-.71-.71L6.58 8 2.72 11.9l-.71.7-1.41-1.4.7-.71 3.9-3.9z"/></svg>'}}]);