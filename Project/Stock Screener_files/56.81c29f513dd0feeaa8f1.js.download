(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{TsgZ:function(t,e,s){"use strict";s.d(e,"a",(function(){return h}));var o=s("mrSG"),r=s("Eyy1"),i=s("IWXC"),n=s("1pWb"),a=s("8woN"),u=s("y8Ih"),c=s("fgbt"),b=s("bKsZ"),l=s("NP3r"),S=s("e3/o"),p=new Map,y=function(){function t(t,e){var s=this;this._symbolDataHandlers=new Map,this._fastSymbols=new Set,this._subscribedSymbols=new Set,this._subscriptionSet=new Set,this._cancelSubscriptionSet=new Set,this._quoteSessionDataHandler=function(t){var e=Object(r.ensureDefined)(t.symbolname),o=s._applyDataFilters(t),i=o.filtered;o.keepSubscription||s._unsubscribeSymbols([e]),s._lastSymbolData.set(e,i);var n=s._symbolDataHandlers.get(e);n&&n(i)},this._clientId=t,this._quoteSession=Object(i.getQuoteSessionInstance)("watchlist"),this._lastSymbolData=e||new Map}return t.prototype.destroy=function(){var t=Array.from(this._subscribedSymbols);this._unsubscribeSymbols(t)},t.prototype.addFastSymbol=function(t){this._fastSymbols.has(t)||!this._subscribedSymbols.has(t)||Object(n.b)(t)||(this._fastSymbols.add(t),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))},t.prototype.removeFastSymbol=function(t){this._fastSymbols.has(t)&&(this._fastSymbols.delete(t),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols)))},t.prototype.addSymbolDataHandler=function(t,e){Object(n.b)(t)||this._symbolDataHandlers.set(t,e)},t.prototype.removeSymbolDataHandler=function(t){this._symbolDataHandlers.delete(t)},t.prototype.addToSubscriptionSet=function(t){var e=this;t.forEach((function(t){Object(n.b)(t)||e._subscriptionSet.add(t)}))},t.prototype.clearSubscriptionSet=function(){this._subscriptionSet.clear()},t.prototype.addToCancelSubscriptionSet=function(t){var e=this;t.forEach((function(t){Object(n.b)(t)||e._cancelSubscriptionSet.add(t)}))},t.prototype.commitSubscriptionChanges=function(){var t=this;Array.from(this._subscriptionSet).forEach((function(e){t._cancelSubscriptionSet.has(e)&&(t._subscriptionSet.delete(e),t._cancelSubscriptionSet.delete(e))})),this._subscribeSymbols(Array.from(this._subscriptionSet)),this._subscriptionSet.clear(),this._unsubscribeSymbols(Array.from(this._cancelSubscriptionSet)),this._cancelSubscriptionSet.clear(),this._quoteSession.setFastSymbols(this._clientId,Array.from(this._fastSymbols))},t.prototype.getLastSymbolData=function(t){return this._lastSymbolData.get(t)},t.prototype.getSymbolSnapshotForAll=function(t,e,s){var o=this;void 0===s&&(s=Object(S.guid)());var r=t.map((function(t){return o.getSymbolSnapshot(t,e,s)}));return Promise.all(r)},t.prototype.getSymbolSnapshot=function(t,e,s){var o=this;if(void 0===s&&(s=Object(S.guid)()),Object(n.b)(t))return Promise.resolve(void 0);var r=this._lastSymbolData.get(t);return r?("ok"===r.status&&m(r,e)&&Promise.resolve(r),Promise.resolve(r)):new Promise((function(r){var i=o._clientId+"_snapshot_"+s,n=function(s){var a=o._applyDataFilters(s),u=a.filtered,c=a.keepSubscription;u&&"error"!==u.status&&o._lastSymbolData.set(t,u),
(!c||m(u,e)||"error"===u.status||u.complete)&&(o._quoteSession.unsubscribe(i,t,n),r(u))};o._quoteSession.subscribe(i,t,n)}))},t.prototype.getSymbolFullName=function(t){var e=this;if(Object(n.b)(t))return Promise.resolve(t);if(p.has(t))return Object(r.ensureDefined)(p.get(t));var s=new Promise((function(s){var o=e._clientId+"_SymbolFullName",r=function(i){var n=function(i){e._quoteSession.unsubscribe(o,t,r),s(i)};i&&"ok"===i.status?i.values&&i.values.pro_name&&n(i.values.pro_name):n(t)};e._quoteSession.subscribe(o,t,r)}));return p.set(t,s),s},t.prototype.getSymbolsFullNames=function(t){var e=this;return Promise.all(t.map((function(t){return e.getSymbolFullName(t)})))},t.prototype.getUniqueSymbolsFullNames=function(t){return this.getSymbolsFullNames(t).then((function(t){return Array.from(new Set(t))}))},t.prototype._subscribeSymbols=function(t){var e=this;this._quoteSession.subscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach((function(t){return e._subscribedSymbols.add(t)}))},t.prototype._unsubscribeSymbols=function(t){var e=this;this._quoteSession.unsubscribe(this._clientId,t,this._quoteSessionDataHandler),t.forEach((function(t){e._subscribedSymbols.delete(t)}))},t.prototype._applyDataFilters=function(t){var e;return e=t,!Object(u.isSfQuoteData)(e)&&!Object(c.isIDCExchange)(Object(a.getExchange)(Object(r.ensureDefined)(e.symbolname)),!0)||Object(l.enabled)(b.ProductFeatures.IDC_AVAILABLE_DELAY)?{filtered:t,keepSubscription:!0}:{filtered:function(t){return Object(o.a)(Object(o.a)({},t),{status:"sf_data",values:{}})}(t),keepSubscription:!1}},t}(),h=new(function(){function t(){this._adapters={},this._lastSymbolData=new Map}return t.prototype.destroy=function(){var t=this;Object.keys(this._adapters).forEach((function(e){return Object(r.ensureDefined)(t._adapters[e]).destroy()})),this._lastSymbolData.clear()},t.prototype.get=function(t){return void 0===this._adapters[t]&&(this._adapters[t]=new y(t,this._lastSymbolData)),Object(r.ensureDefined)(this._adapters[t])},t}());function m(t,e){for(var s=0,o=Array.from(e);s<o.length;s++){var r=o[s];if(!t.values.hasOwnProperty(r))return!1}return!0}}}]);